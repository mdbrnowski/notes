\begin{definition}
    \label{d:linear map}
    Odwzorowanie
    \[ f : V \to W, \]
    gdzie $V, W$ są przestrzeniami liniowymi nad tym samym ciałem $\KK$ jest \vocab{liniowe}, jeśli
    \[ \dforall{u, v \in V} f(u + v) = f(u) + f(v) \]
    oraz
    \[ \dforall{v \in V, \alpha \in \KK} f(\alpha v) = \alpha f(v), \]
    to znaczy, kiedy jest \vocab{addytywne} oraz \vocab{jednorodne}.
\end{definition}

Podobnie jak w przypadku homomorfizmu grup (definicja \ref{d:homomorphism}), elementy przeciwne oraz neutralne są zachowywane. Analogicznie do równoważnej charakterystyki podprzestrzeni (fakt \ref{f:equivalent subspace characteristics}) warunki z powyższej definicji są równoważne warunkowi
\begin{equation}
    \label{eq:equivalent liner map condition}
    \dforall{\alpha, \beta \in \KK}\dforall{u, v \in V} f(\alpha u + \beta v) = \alpha f(u) + \beta f(v).
\end{equation}

\begin{corollary}[z równania \ref{eq:equivalent liner map condition}]
    \label{c:linear map is unique by the values f(B)}
    Odwzorowanie liniowe $f$ jest jednoznacznie określone przez wartości $f$ na wektorach bazowych dziedziny.
\end{corollary}
\begin{proof}
    Wzór \ref{eq:equivalent liner map condition} można rozszerzyć do większej liczby składników używając $(\alpha, \beta, \gamma, \ldots)$ oraz $(u, v, w, \ldots)$. Taka postać również będzie równoważna definicji \ref{d:linear map}. Możemy policzyć wartość $f$ dla każdego wektora, znając jego współrzędne w pewnej bazie $B$ oraz wartości $f$ dla wszystkich wektorów z tej bazy.
\end{proof}

\begin{definition}
    Jądro odwzorowania liniowego $f : V \to W$ to zbiór
    \[ \Ker f = f^{-1}(\{\ol{0}\}) = \{v \in V \mid f(v) = \ol{0}\}. \]
\end{definition}

\begin{definition}
    Obraz odwzorowania liniowego $f : V \to W$ to zbiór
    \[ \Im f = f(V) = \{w \in W \mid \exists v \in V : w = f(v)\}. \]
    Jeśli $B$ jest bazą przestrzeni $V$, to
    \[ \Im f = \Lin f(B). \]
\end{definition}

\begin{fact}
    Dla każdego odwzorowania liniowego $f : V \to W$, jądro $f$ jest podprzestrzenią $V$, a obraz $f$ jest podprzestrzenią $W$.
\end{fact}

Wymiar jądra pewnego odwzorowania $f$ nazywamy \vocab{zerowością} i oznaczamy $\nullity f$, a wymiar jego obrazu nazywamy \vocab{rzędem} i oznaczamy $\rank f$.

\begin{example}
    Weźmy odwzorowanie $f : \RR^3 \to \RR^2$ takie, że
    \[ f(x, y, z) = (x, y). \]
    Znajdźmy jądro i obraz tego odwzorowania.
    \[ \Ker f = \{(0, 0, z) : z \in \RR\}, \quad \dim = 1. \]
    \[ \Im f = \RR^2, \quad \dim = 2. \]
    Teraz weźmy $g : \RR^2 \to \RR^3$ takie, że
    \[ g(x, y) = (x, y, x + y). \]
    Znajdźmy jądro i obraz tego odwzorowania.
    \[ \Ker g = \{\ol{0}\}, \quad \dim = 0. \]
    \[ \Im g = \{(x, y, x+y) : x, y \in \RR\}, \quad \dim = 2. \]
\end{example}

\begin{theorem}[o rzędzie]
    \label{t:rank-nullity}
    Jeśli $V, W$ są skończenie wymiarowymi przestrzeniami wektorowymi nad ciałem $\KK$ oraz $f : V \to W$ jest odwzorowaniem liniowym, to
    \[ \nullity f + \rank f = \dim V, \]
    \[ \dim \Ker f + \dim \Im f = \dim V. \]
\end{theorem}
\begin{proof}
    Niech $n = \dim V$ oraz $k = \dim \Ker f$. Skoro $\Ker f$ jest podprzestrzenią przestrzeni $V$, to jeśli $n = k$, to dla każdego $\mathbf{v} \in V$ zachodzi $f(\mathbf{v}) = \ol{0}$, więc $\Im f = \{\ol{0}\}$, ergo teza jest spełniona. Dalej załóżmy więc, że $n > k$. Istnieje taka baza przestrzeni $V$, która ma postać
    \[ \{\mathbf{v}_1, \ldots, \mathbf{v}_k, \mathbf{u}_{k+1}, \ldots, \mathbf{u}_n\}, \]
    gdzie $\{\mathbf{v}_1, \ldots, \mathbf{v}_k\}$ jest bazą $\Ker f$. Weźmy dowolny wektor $\mathbf{v} \in V,$
    \[ \mathbf{v} = t_1\mathbf{v}_1 + \ldots + t_k\mathbf{v}_k + t_{k+1}\mathbf{u}_{k+1} + \ldots + t_n\mathbf{u}_n. \]
    Wtedy
    \begin{align*}
        \mathbf{w} = f(\mathbf{v}) &= f(t_1\mathbf{v}_1 + \ldots + t_k\mathbf{v}_k + t_{k+1}\mathbf{u}_{k+1} + \ldots + t_n\mathbf{u}_n) \\
            &= f(t_1\mathbf{v}_1) + \ldots + f(t_k\mathbf{v}_k) + f(t_{k+1}\mathbf{u}_{k+1}) + \ldots + f(t_n\mathbf{u}_n) \\
            &= t_1f(\mathbf{v}_1) + \ldots + t_kf(\mathbf{v}_k) + t_{k+1}f(\mathbf{u}_{k+1}) + \ldots + ft_n(\mathbf{u}_n) \\
            &= t_1(0) + \ldots + t_k(0) + t_{k+1}f(\mathbf{u}_{k+1}) + \ldots + ft_n(\mathbf{u}_n) \\
            &= t_{k+1}f(\mathbf{u}_{k+1}) + \ldots + ft_n(\mathbf{u}_n),
    \end{align*}
    więc
    \[ \Im f = \Lin\{f(\mathbf{u}_{k+1}), \ldots, f(\mathbf{u}_n)\}. \]
    Wystarczy już tylko udowodnić, że wektory $f(\mathbf{u}_{k+1}), \ldots, f(\mathbf{u}_n)$ są liniowo niezależne. Weźmy ciąg skalarów $(s_i)$ taki, że
    \begin{align*}
        s_{k+1}f(\mathbf{u}_{k+1}) + \ldots + s_nf(\mathbf{u}_n) &= \ol{0} \\
        f(s_{k+1}\mathbf{u}_{k+1}) + \ldots + f(s_n\mathbf{u}_n) &= \ol{0} \\
        f(s_{k+1}\mathbf{u}_{k+1} + \ldots + s_n\mathbf{u}_n) &= \ol{0}.
    \end{align*}
    Z tego wynika, że
    \[ (s_{k+1}\mathbf{u}_{k+1} + \ldots + s_n\mathbf{u}_n) \in \Ker f, \]
    więc $(s_{k+1}\mathbf{u}_{k+1} + \ldots + s_n\mathbf{u}_n) \in V$ możemy zapisać jako kombinację liniową wektorów $\mathbf{v}_1, \ldots, \mathbf{v}_k$. Zakładając, że ciąg $(s_i)$ jest niezerowy, mamy dwa sposoby zapisu jednego wektora z $V$, co stoi w sprzeczności z twierdzeniem \ref{t:explicit coefficients}. Z tego wynika, że $\forall i : s_i = 0$, więc wektory $f(\mathbf{u}_{k+1}), \ldots, f(\mathbf{u}_n)$ są liniowo niezależne, ergo
    \[ \dim \Im f = n - k \]
    \[ \rank f = \dim V - \nullity f. \]
\end{proof}

\begin{definition}
    Przy danych przestrzeniach wektorowych $V, W$ nad ciałem $\KK$, odwzorowanie liniowe $f : V \to W$ to:
    \begin{itemize}
        \item \vocab{monomorfizm}, jeśli jest injekcją,
        \item \vocab{epimorfizm}, jeśli jest surjekcją,
        \item \vocab{izomorfizm}, jeśli jest bijekcją,
        \item \vocab{endomorfizm}, jeśli $V = W$,
        \item \vocab{automorfizm}, jeśli jest endomorfizmem i izomorfizmem,
        \item \vocab{forma liniowa}, jeśli $W = \KK$.
    \end{itemize}
\end{definition}

\begin{theorem}
    Odwzorowanie liniowe $f : V \to W$ jest epimorfizmem wtedy i tylko wtedy, gdy $\dim\Im f = \dim W$.
\end{theorem}
\begin{proof}
    $\Im f$ jest podprzestrzenią $W$, więc wynika z twierdzenia \ref{t:dimU = dimV, U subspace V}.
\end{proof}

\begin{theorem}
    Odwzorowanie liniowe $f : V \to W$ jest monomorfizmem wtedy i tylko wtedy, gdy $\Ker f = \{\ol{0}\}$.
\end{theorem}
\begin{proof}
    Implikacja prawostronna jest trywialna, dlatego udowodnimy tylko lewostronną. Załóżmy przeciwnie, że istnieje takie $\mathbf{v}_1 \neq \mathbf{v}_2$, że
    \[ f(\mathbf{v}_1) = f(\mathbf{v}_2). \]
    Wtedy
    \[ f(\mathbf{v}_1) - f(\mathbf{v}_2) = f(\mathbf{v}_2) - f(\mathbf{v}_1) = \ol{0} \]
    \[ f(\mathbf{v}_1 - \mathbf{v}_2) = f(\mathbf{v}_2 - \mathbf{v}_1) = \ol{0}, \]
    co, skoro $\mathbf{v}_1 - \mathbf{v}_2 \neq \ol{0}$, przeczy założeniu $\Ker f = \{\ol{0}\}$.
\end{proof}

\begin{theorem}
    Jeśli $V, W$ są skończenie wymiarowymi przestrzeniami wektorowymi nad ciałem $\KK$, to ich izomorficzność jest równoważna równości ich wymiarów
    \[ V \sim W \quad \iff \quad \dim V = \dim W. \]
\end{theorem}
\begin{proof}
    Wynika z wniosku \ref{c:linear map is unique by the values f(B)}.
\end{proof}

\begin{theorem}
    Niech $V, W$ będą pewnymi przestrzeniami nad ciałem $\KK$, a $\sL(V, W)$ zbiorem wszystkich odwzorowań liniowych między nimi. Struktura $(\sL(V, W), \KK, +, \cdot)$ jest przestrzenią wektorową.
\end{theorem}
\begin{proof}
    Z definicji.
\end{proof}

\subsection{Macierze odwzorowań liniowych}
\begin{definition}
    \label{d:transformation matrix}
    Niech $B_V = (e_1, e_2, \ldots, e_n), B_W = (l_1, l_2, \ldots, l_m)$ będą pewnymi bazami odpowiednio przestrzeni $V, W$ nad ciałem $\KK$. Niech $f : V \to W$ będzie odwzorowaniem liniowym takim, że
    \begin{align*}
        f(e_1) &= a_{11}l_1 + a_{21}l_2 + \ldots + a_{m1}l_m, \\
        f(e_2) &= a_{12}l_1 + a_{22}l_2 + \ldots + a_{m2}l_m, \\
        \vdots \\
        f(e_n) &= a_{1n}l_1 + a_{2n}l_2 + \ldots + a_{mn}l_m.
    \end{align*}
    \vocab{Macierz odwzorowania liniowego} $f$ w bazach $B_V, B_W$ to macierz
    \[ M_f(B_V, B_W) = \begin{bNiceMatrix}
        a_{11} & a_{12} & \Cdots & a_{1n} \\
        a_{21} & a_{22} & \Cdots & a_{2n} \\
        \Vdots & \Vdots & \Ddots & \Vdots \\
        a_{m1} & a_{m2} & \Cdots & a_{mn}
    \end{bNiceMatrix}. \]
\end{definition}

\begin{fact}
    \label{f:matix form of linear map}
    Równanie $y = f(x)$ można zapisać w postaci macierzowej jako
    \[ \begin{bNiceMatrix}y_1 \\ y_2  \\ \Vdots \\ y_m\end{bNiceMatrix} = \begin{bNiceMatrix}
        a_{11} & a_{12} & \Cdots & a_{1n} \\
        a_{21} & a_{22} & \Cdots & a_{2n} \\
        \Vdots & \Vdots & \Ddots & \Vdots \\
        a_{m1} & a_{m2} & \Cdots & a_{mn}
    \end{bNiceMatrix}\begin{bNiceMatrix}x_1 \\ x_2  \\ \Vdots \\ x_n\end{bNiceMatrix}, \]
    gdzie $f : B_V \to B_W$ jest odwzorowaniem liniowym, $[a_{ij}]_{m\times n} = M_f(B_V, B_W)$ oraz
    \[ x = [x_1, x_2, \ldots, x_n]_{B_V}^T, \quad y = [y_1, y_2, \ldots, y_m]_{B_W}^T. \]
\end{fact}
\begin{proof}
    Skoro $x = [x_1, x_2, \ldots, x_n]_{B_V}^T$ oraz $y = [y_1, y_2, \ldots, y_m]_{B_W}^T$, to
    \[ x = x_1e_1 + x_2e_2 + \ldots + x_ne_n, \quad y = y_1l_1 + y_2l_2 + \ldots + y_ml_m, \]
    więc
    \begin{align}
        f(x) &= f(x_1e_1 + x_2e_2 + \ldots + x_ne_n) \nonumber \\
        f(x) &= x_1f(e_1) + x_2f(e_2) + \ldots + x_nf(e_n) \nonumber \\
        f(x) &= x_1\begin{bNiceMatrix}a_{11} \\ a_{21} \\ \Vdots \\ a_{m1}\end{bNiceMatrix}
            + x_2\begin{bNiceMatrix}a_{12} \\ a_{22} \\ \Vdots \\ a_{m2}\end{bNiceMatrix}
            + \ldots
            + x_n\begin{bNiceMatrix}a_{1n} \\ a_{2n} \\ \Vdots \\ a_{mn}\end{bNiceMatrix}
            \label{eq:matrix form of linear map - linear combination}
    \end{align}

    Mnożąc macierze jak w udowadnianej tezie otrzymalibyśmy
    \[ y = \begin{bNiceMatrix}
        a_{11}x_1 + a_{12}x_2 + \ldots + a_{1n}x_n \\
        a_{21}x_1 + a_{22}x_2 + \ldots + a_{2n}x_n \\
        \Vdots \\
        a_{m1}x_1 + a_{m2}x_2 + \ldots + a_{mn}x_n \\
    \end{bNiceMatrix}, \]
    czyli to samo co wyżej.
\end{proof}

Jeśli odwzorowanie $f$ jest endomorfizmem, to macierz tego odwzorowania w bazie $B$ oznaczamy jako $M_f(B)$.

\begin{theorem}
    Jeśli $f : V \to W$ będzie odwzorowaniem liniowym, a $B_V, B_W$ to bazy odpowiednio przestrzeni $V, W$, to
    \[ \rank f = \rank M_f(B_V, B_W). \]
\end{theorem}
\begin{proof}
    Przypomnijmy, że
    \[ \Im f = \{y \in W \mid \exists x \in V : y = f(x)\}. \]
    Korzystając z faktu \ref{f:matix form of linear map}, możemy przekształcić powyższe do
    \[ \Im f = \{M_f(B_V, B_W)\cdot x \mid x \in V\}, \]
    z czego wynika, że obraz przekształcenia $f$ jest tożsamy z przestrzenią rozpinaną przez kolumny macierzy $M_f(B_V, B_W)$ (zobacz równanie \ref{eq:matrix form of linear map - linear combination}). Z tego powodu również ich wymiary są równe.
\end{proof}

\begin{theorem}
    Niech $f, g : V \to W$ będą odwzorowaniami liniowymi, $B_V, B_W$ to bazy odpowiednio przestrzeni $V, W$ nad ciałem $\KK$, a $\alpha \in \KK$, to
    \begin{enumerate}
        \item $M_{f+g}(B_V, B_W) = M_f(B_V, B_W) + M_g(B_V, B_W)$,
        \item $M_{\alpha f}(B_V, B_W) = \alpha M_f(B_V, B_W)$,
    \end{enumerate}
\end{theorem}
\begin{proof}
    Z definicji.
\end{proof}

\begin{theorem}
    Niech $f : V \to W, g : W \to U$ będą odwzorowaniami liniowymi, a $B_V, B_W, B_U$ to bazy odpowiednio przestrzeni $V, W, U$, to
    \[ M_{g\circ f}(B_V, B_U) = M_g(B_W, B_U) \cdot M_f(B_V, B_W). \]
\end{theorem}
\begin{proof}
    Z definicji oraz faktu \ref{f:matix form of linear map}.
\end{proof}

\begin{corollary}[z faktu \ref{f:matix form of linear map}]
    Endomorfizm $f : V \to V$ jest automorfizmem (bijekcją) wtedy i tylko wtedy, gdy macierz przekształcenia liniowego jest odwracalna (nieosobliwa). Łatwo również znaleźć przekształcenie odwrotne $f^{-1}$:
    \[ M_{f^{-1}}(B_2, B_1) = (M_f(B_1, B_2))^{-1}. \]
\end{corollary}

\begin{definition}
    Macierz przejścia $P_{B \to B'}$ od bazy $B = (e_1, e_2, \ldots, e_n)$ do bazy $B' = (e_1', e_2', \ldots, e_n')$ przestrzeni $V$ to macierz odwzorowania identycznościowego danej przestrzeni w bazach $B', B$,
    \[ P_{B\to B'} = M_{\opname{Id}_V}(B', B). \]
    Wtedy, jeśli $X, X'$ są wektorami kolumnowymi z $V$ względem baz $B, B'$, to
    \[ X = P_{B \to B'}X'. \]
\end{definition}

\begin{remark*}
    W powyżej opisanej macierzy $j$-tą kolumnę tworzą współrzędne $j$-tego wektora bazy $B'$ względem bazy $B$. Najłatwiej jest więc wtedy, gdy baza $B$ jest bazą kanoniczną.
\end{remark*}

\begin{theorem}[o zmianie macierzy odwzorowania przy zmianie baz]
    \label{t:changing transformation matrix when changing bases}
    Niech $f: V \to W$ będzie odwzorowaniem liniowym, a $B_V, B_V', B_W, B_W'$ pewnymi bazami odpowiednich przestrzeni liniowych. Wtedy
    \[ M_f(B_V', B_W') = (P_{B_W \to B_W'})^{-1} \cdot M_f(B_V, B_W) \cdot P_{B_V \to B_V'}. \]
\end{theorem}
\begin{proof}
    Mamy
    \[ P_{B_W' \to B_W} \cdot M_f(B_V, B_W) \cdot P_{B_V \to B_V'} = M_{\opname{Id}_W}(B_W, B_W') \cdot M_f(B_V, B_W) \cdot M_{\opname{Id}_V}(B_V', B_V) \]
\end{proof}

\begin{example}
    Dane jest odwzorowanie liniowe $f : \RR^3 : \RR^2$ takie, że
    \[ M_f(B_1', B_2') = \begin{bmatrix}
        2 & 1 & 2 \\
        -1 & 0 & 0
    \end{bmatrix}, \]
    gdzie
    \begin{align*}
        B_1' &= ((1, 1, 0), (0, 1, 1), (1, 1, 1)), \\
        B_2' &= ((1, 1), (-1, 1)).
    \end{align*}
    Znajdź macierz odwzorowania $f$ w bazach
    \begin{align*}
        B_1 &= ((1, 0, 0), (0, 1, 0), (0, 0, 1)), \\
        B_2 &= ((1, 0), (0, 1)).
    \end{align*}
\end{example}
\begin{solution}
    Z twierdzenia \ref{t:changing transformation matrix when changing bases} mamy
    \[ M_f(B_1, B_2) = P_{B_2 \to B_2'} \cdot M_f(B_1', B_2') \cdot P_{B_1' \to B_1}. \]
    Macierz przejścia $B_2 \to B_2'$ jest bardzo łatwo wyznaczyć, ponieważ $B_2$ to baza kanoniczna. W przypadku macierzy przejścia $B_1' \to B_1$ najłatwiej będzie wyznaczyć jej odwrotność, ponieważ $B_1$ jest bazą kanoniczną. Mamy więc
    \[ M_f(B_1, B_2) = \begin{bmatrix}
        1 & -1 \\
        1 & 1
    \end{bmatrix} \cdot \begin{bmatrix}
        2 & 1 & 2 \\
        -1 & 0 & 0
    \end{bmatrix} \cdot \begin{bmatrix}
        1 & 0 & 1\\
        1 & 1 & 1\\
        0 & 1 & 1
    \end{bmatrix}^{-1} = \cdots = \begin{bmatrix}
        1 & 2 & -1 \\
        1 & 0 & 1
    \end{bmatrix} \]
\end{solution}

\begin{definition}
    \label{d:matrix equivalence}
    Macierze $A, B \in M_{m\times n}$ są równoważne, jeśli istnieją takie nieosobliwe macierze $P, Q$, że
    \[ B = Q^{-1} \cdot A \cdot P. \]
\end{definition}

\begin{definition}
    \label{d:matrix similarity}
    Macierze $A, B \in M_{m\times n}$ są podobne, jeśli istnieje taka nieosobliwa macierz $P$, że
    \[ B = P^{-1} \cdot A \cdot P. \]
\end{definition}

Z definicji wynika, że dwie macierze pewnego odwzorowania liniowego są równoważne, a dwie macierze pewnego endomorfizmu są podobne. Ponadto, łatwo wykazać, że macierze równoważne mają równe rzędy, a podobne --- rzędy i wyznaczniki.