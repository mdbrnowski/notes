Zbiór funkcji \vocab{całkowalnych z kwadratem} będziemy oznaczać przez $L^2[a, b]$. Formalnie
\[ L^2[a, b] = \left\{f: [a, b] \to \RR : \int\limits_{[a, b]} f^2(x) \d x < \infty \right\}. \]
Jeśli utożsamimy ze sobą funkcje, które różnią się zbiorze miary Riemanna równej zero, to struktura $(L^2[a, b], \RR, +, \cdot)$ jest przestrzenią wektorową, w której możemy wprowadzić iloczyn skalarny
\[ f \circ g = \int\limits_{[a, b]} f(x)g(x) \d x. \]
Mamy więc przestrzeń unitarną, ergo zdefiniowana jest w niej też norma
\[ \Vert f \Vert = \sqrt{f \circ f} = \sqrt{\int_a^b f^2(x) \d x} \]
oraz metryka
\[ d(f, g) = \Vert f - g \Vert = \sqrt{\int_a^b \left(f(x) - g(x)\right)^2 \d x}. \]
Zbieżność w sensie metryki $d$ to \vocab{zbieżność przeciętna z kwadratem}.

\begin{definition}
    Ciąg ortogonalny to taki ciąg funkcyjny $(\varphi_n)_{n\geq 0}$, którego funkcje nie są tożsamościowo równe zeru, są całkowalne z kwadratem oraz jego elementy są prostopadłe, czyli
    \[ \dforall{i \neq j} \varphi_i \circ \varphi_j = 0. \]
\end{definition}

\begin{definition}
    Ciąg ortonormalny to taki ciąg ortogonalny, że jego elementy są wersorami, czyli
    \[ \dforall{i, j} \varphi_i \circ \varphi_j = \begin{cases}1, & \text{dla } i = j \\ 0, & \text{dla } i \neq j\end{cases}. \]
    Wartość $\varphi_i \circ \varphi_j$ oznaczamy $\delta_{ij}$ i nazywamy \vocab{deltą Kroneckera}.
\end{definition}

\vocab{Szeregiem ortogonalnym} będziemy nazywać szereg funkcyjny w postaci $\sum_{n=0}^\infty c_n\varphi_n$, gdzie $(c_n)$ jest ciągiem liczb rzeczywistych, a $(\varphi_n)$ ciągiem ortogonalnym.

\begin{theorem}[współczynniki Eulera-Fouriera]
    \label{t:Euler-Fourier}
    Jeśli szereg
    \[ \sum_{n=0}^\infty c_n\varphi_n \rightrightarrows f \]
    jest ortogonalny i zbiega jednostajnie do funkcji $f \in L^2[a, b]$, to dla każdego $n \in \NN$
    \[ c_n = \frac{f \circ \varphi_n}{\Vert \varphi_n \Vert^2}. \]
\end{theorem}

\begin{proof}
    Niech
    \[ f(x) = \sum_{n=0}^\infty c_n\varphi_n. \]
    Wybierzmy dowolne $m \in \NN$. Mamy
    \begin{align*}
        f(x) \cdot \varphi_m (x)
        &= \sum_{n=0}^\infty c_n \varphi_n(x) \cdot \varphi_m(x), \\
        \int_a^b f(x) \varphi_m(x) \d x
        &= \int_a^b \sum_{n=0}^\infty c_n \varphi_n(x) \varphi_m(x) \d x.
    \end{align*}
    Skoro szereg jest zbieżny jednostajnie, to (korzystając z twierdzenia \ref{t:integrable series}) możemy zamienić znaki sumy i całki, otrzymując
    \[ \int_a^b f(x) \varphi_m(x) \d x = \sum_{n=0}^\infty c_n \int_a^b \varphi_n(x) \varphi_m(x) \d x, \]
    a ponieważ $(\varphi_n)_{n \in \NN}$ jest ciągiem ortogonalnym (czyli dla $n \neq m$, $\int_a^b \varphi_n(x) \varphi_m(x) = 0$), suma sprowadza się do
    \begin{align*}
        \int_a^b f(x) \varphi_m(x) \d x
        &= c_m \int_a^b \varphi_m(x) \varphi_m(x) \d x \\
        f \circ \varphi_m
        &= c_m \cdot (\varphi_m \circ \varphi_m)
        = c_m \cdot \Vert \varphi_m \Vert^2 \\
        \frac{f \circ \varphi_m}{\Vert \varphi_m \Vert^2}
        &= c_m.
    \end{align*}
\end{proof}

Szereg ortogonalny, w którym współczynniki mają powyższą formę, nazywamy \vocab{szeregiem Fouriera} funkcji $f$. Oznaczamy
\[ f \sim \sum_{n=0}^\infty c_n\varphi_n. \]
Jeśli powyższy szereg ortogonalny jest zbieżny do $f$ na całym przedziale $[a, b]$, to mówimy, że ta funkcja jest \vocab{rozwijalna} w szereg Fouriera.

\begin{theorem}[nierówność Bessela]
    Jeśli szereg
    \[ \sum_{n=0}^\infty c_n\varphi_n \]
    jest szeregiem Fouriera funkcji $f$ względem ciągu $(\varphi_n)$, to
    \[ \Vert f \Vert^2 \geq \sum_{n=0}^\infty c_n^2 \Vert \varphi_n \Vert^2. \]
\end{theorem}

\begin{theorem}[tożsamość Parsevala]
    \label{t:Parseval}
    Jeśli szereg
    \[ \sum_{n=0}^\infty c_n\varphi_n \]
    jest szeregiem Fouriera funkcji $f$ względem ciągu $(\varphi_n)$, to
    \[ \Vert f \Vert^2 = \sum_{n=0}^\infty c_n^2 \Vert \varphi_n \Vert^2 \]
    wtedy i tylko wtedy, gdy $\sum_{n=0}^\infty c_n\varphi_n$ jest przeciętnie zbieżny z kwadratem do $f$.
\end{theorem}

Jeśli pewien szereg spełnia tożsamość Parsevala dla każdej funkcji $f \in L^2[a, b]$, to mówimy, że ciąg $(\varphi_n)$ jest \vocab{zupełny}.

\begin{corollary}
    Jeśli ciąg $(\varphi_n)$ jest zupełny oraz $f \sim \sum_{n=0}^\infty c_n\varphi_n$, to szereg
    \[ \sum_{n=0}^\infty c_n\varphi_n \]
    jest przeciętnie zbieżny z kwadratem do $f$ na $[a, b]$.
\end{corollary}

\subsection{Trygonometryczne szeregi Fouriera}
\begin{fact}
    Ciąg
    \[ 1, \cos x, \sin x, \cos 2x, \sin 2x, \ldots, \cos nx, \sin nx, \ldots \]
    jest zupełny (a więc i ortogonalny).
\end{fact}

\begin{corollary}[współczynniki Eulera-Fouriera (\ref{t:Euler-Fourier}) dla szeregów trygonometrycznych]
    \label{c:Euler-Fourier for trig}
    Szeregiem trygonometrycznym Fouriera funkcji całkowalnej $f : [-\pi, \pi] \to \RR$ będziemy nazywać szereg
    \[ \frac{a_0}{2} + \sum_{n=1}^\infty a_n\cos nx + b_n\sin nx, \]
    gdzie
    \begin{align*}
        a_0 &= \frac{1}{\pi}\int_{-\pi}^\pi f(x) \d x \\
        a_n &= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos nx \d x \\
        b_n &= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin nx \d x.
    \end{align*}
\end{corollary}

\begin{definition}[warunki Dirichleta] ~
    \begin{enumerate}
        \item funkcja $f : [a, b] \to \RR$ jest ograniczona,
        \item funkcja $f$ ma skończoną liczbę przedziałów monotoniczności,
        \item funkcja $f$ ma skończoną liczbę punktów nieciągłości $x_0$ oraz
        \[ f(x_0) = \frac{\lim\limits_{x\to x_0^-}f(x) + \lim\limits_{x\to x_0^+}f(x)}{2}, \]
        \item zachodzi równość
        \[ f(a) = f(b) = \frac{\lim\limits_{x\to a^+}f(x) + \lim\limits_{x\to b^-}f(x)}{2}. \]
    \end{enumerate}
\end{definition}

\begin{theorem}[o rozwijaniu funkcji w szereg Fouriera]
    Jeśli funkcja $f$ spełnia warunki Dirichleta w przedziale $[-\pi, \pi]$, to szereg trygonometryczny Fouriera tej funkcji jest zbieżny punktowo do $f$ na $[-\pi, \pi]$.
\end{theorem}

\begin{remark}
    Jeśli funkcja $f$ spełnia warunki Dirichleta w przedziale $[-\pi, \pi]$ oraz jest nieparzysta, to
    \[ f(x) = \sum_{n=1}^\infty b_n\sin nx, \]
    gdzie $b_n = \frac{2}{\pi}\int_0^\pi f(x)\sin nx \d x$. Jeśli jest parzysta, to
    \[ f(x) = \frac{a_0}{2} + \sum_{n=1}^\infty a_n\cos nx, \]
    gdzie $a_n = \frac{2}{\pi}\int_0^\pi f(x)\cos nx \d x$. Tworzą one wtedy odpowiednio szereg sinusów i cosinusów.
\end{remark}

\begin{example}
    Rozwiń w szereg Fouriera funkcję
    \[ f(x) = \begin{cases}
        0, & \text{dla } x \in (-\pi, 0) \\
        x, & \text{dla } x \in [0, \pi)
    \end{cases}. \]
    Korzystając z niego, oblicz sumę szeregu liczbowego $1 + \frac{1}{3^2} + \frac{1}{5^2} + \ldots$.
\end{example}
\begin{solution}
    Aby funkcja $f$ spełniała wszystkie warunki Dirichleta, musimy dodać wartość w punkcie $x = \pm \pi$.
    \[ f(-\pi) = f(\pi) = \frac{\lim\limits_{x\to -\pi^+}f(x) + \lim\limits_{x\to \pi^-}f(x)}{2} = \frac{0 + \pi}{2} = \frac{\pi}{2}. \]
    Możemy więc już napisać
    \[ f(x) = \frac{a_0}{2} + \sum_{n=1}^\infty a_n\cos nx + b_n\sin nx, \]
    gdzie
    \begin{align*}
        a_0 &= \frac{1}{\pi}\int_{-\pi}^\pi f(x) \d x = \frac{1}{\pi}\left(\int_{-\pi}^0 0 \d x + \int_0^\pi x \d x\right) = \frac{1}{\pi}\left(\frac{\pi^2}{2}\right) = \frac{\pi}{2}, \\
        a_n &= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos{nx} \d x = \frac{1}{\pi}\left(\int_{-\pi}^0 0 \d x + \int_0^\pi x \cos{nx} \d x\right) = \\
            &= \frac{1}{\pi}\left(\left[\frac{nx\sin{nx} + \cos{nx}}{n^2}\right]_0^\pi\right) = \frac{n\pi\sin{n\pi} + \cos{n\pi}}{\pi n^2} = \frac{\cos{n\pi} - 1}{\pi n^2} = \frac{(-1)^n - 1}{\pi n^2}, \\
        b_n &= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin{nx} \d x = \frac{1}{\pi}\left(\int_{-\pi}^0 0 \d x + \int_0^\pi x \sin{nx} \d x\right) = \\
            &= \frac{1}{\pi}\left(\left[\frac{-nx\cos{nx} + \sin{nx}}{n^2}\right]_0^\pi\right) = \frac{1}{\pi}\frac{\sin{n\pi} - n\pi\cos{n\pi}}{n} = \frac{-\cos{n\pi}}{n} = \frac{(-1)^{n+1}}{n}.
    \end{align*}
    Mamy więc
    \[ f(x) = \frac{\pi}{4} + \sum_{n=1}^\infty \frac{(-1)^n - 1}{\pi n^2}\cos{nx} + \frac{(-1)^{n+1}}{n}\sin{nx}. \]
    W punkcie $x = \pi$:
    \[ f(\pi) = \frac{\pi}{4} + \sum_{n=1}^\infty \frac{(-1)^n - 1}{\pi n^2}(-1)^n = \frac{\pi}{4} + \sum_{n=1}^\infty \frac{1 - (-1)^n}{\pi n^2} = \frac{\pi}{4} + \frac{2}{\pi}\left(1 + \frac{1}{3^2} + \frac{1}{5^2} + \ldots\right), \]
    ergo
    \[ 1 + \frac{1}{3^2} + \frac{1}{5^2} + \ldots = \frac{\pi}{2}\left(f(\pi) - \frac{\pi}{4}\right) = \frac{\pi}{2}\left(\frac{\pi}{2} - \frac{\pi}{4}\right) = \frac{\pi^2}{8}. \]
\end{solution}

\begin{corollary}[tożsamość Parsevala (\ref{t:Parseval}) dla szeregów trygonometrycznych]
    Przyjmujemy oznaczenia jak we wniosku \ref{c:Euler-Fourier for trig}. Zachodzi równość
    \[ \frac{1}{\pi}\int_{-\pi}^\pi \left(f(x)\right)^2 \d x = \frac{a_0^2}{2} + \sum_{n=1}^\infty a_n^2 + b_n^2. \]
\end{corollary}

\begin{example}
    Rozwiń w szereg Fouriera funkcję
    \[ f(x) = x^2 \]
    dla $x \in [-\pi, \pi]$. Korzystając z tego rozwinięcia, oblicz sumę szeregów liczbowych
    \[ \sum_{n=1}^\infty \frac{1}{n^2} \text{ oraz } \sum_{n=1}^\infty \frac{1}{n^4}. \]
\end{example}
\begin{solution}
    \href{https://www.youtube.com/watch?v=2VYBGF_MPIU}{blackpenredpen na YouTube}. Wynik to odpowiednio $\frac{\pi^2}{6}$ i $\frac{\pi^4}{90}$.
\end{solution}
