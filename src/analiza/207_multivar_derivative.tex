\begin{definition}
    Pochodną funkcji $f : \RR^k \supset D \to \RR^m$ wzdłuż wektora $\vec{v}$ nazwiemy taką funkcję $D_v f$, że
    \[ D_v f(x) = \lim_{t\to 0}\frac{f(x + t\vec{v}) - f(x)}{t}. \]
\end{definition}

Oprócz notacji Eulera ($D_v f$) stosuje się również notację Leibniza ($D_v f(x) = \frac{\p f(x)}{\p{\vec{v}}})$ oraz  Lagrange'a ($f'_{\vec{v}}$).

Pochodna \vocab{w kierunku} wektora $\vec{v}$ jest pochodną wzdłuż wektora $\frac{\vec{v}}{\Vert\vec{v}\Vert}$. Te pojęcia są oczywiście równoważne, jeśli $\vec{v}$ jest wersorem. Najczęściej używamy jednak \vocab{pochodnych cząstkowych} to znaczy pochodnych wzdłuż wersorów osiowych, oznaczając
\[ \frac{\p f}{\p x}(x, y) = \frac{\p f}{\p [1, 0]}(x, y) \hspace{1em}\text{ oraz }\hspace{1em} \frac{\p f}{\p y}(x, y) = \frac{\p f}{\p [0, 1]}(x, y). \]

\begin{definition}[różniczka]
    Funkcja $f : \RR^k \supset D \to \RR^m$ jest różniczkowalna w $p$, gdy istnieje takie przekształcenie liniowe $L_{p} : \RR^k \to \RR^m$, że dla każdego $p + h$ w otoczeniu $p$ zachodzi
    \[ \lim_{h\to\vec{0}} \frac{f(p + h) - f(p) - L_{p}(h)}{\Vert h \Vert} = \vec{0}. \]
    Funkcję $L_{p}(h)$ nazywamy różniczką funkcji $f$ w punkcie $p$ i oznaczamy $\d f(p)(h)$.
\end{definition}

\begin{theorem}[warunek konieczny różniczkowalności]
    \label{t:differentiability implies derivability}
    Jeśli funkcja $f : \RR^k \supset D \to \RR^m$ jest różniczkowalna w punkcie $p$, to istnieje pochodna funkcji $f$ w punkcie $p$ wzdłuż dowolnego wektora $h \in \RR^k$ i zachodzi
    \[ \frac{\p f}{\p h}(p) = \d f(p)(h). \]
\end{theorem}
\begin{proof}[Wyprowadzenie wzoru]
    Pamiętając, że $\d f(p)$ jest przekształceniem liniowym, więc może być rozpatrywane jako macierz, możemy równoważnie stwierdzić, że
    \[ \lim_{h\to\vec{0}} \frac{f(p + h) - f(p) - \d f(p) \cdot h}{\Vert h \Vert} = \vec{0} \]
    \[ \lim_{t\to 0} \frac{f(p + th) - f(p) - \d f(p) \cdot th}{t} = \vec{0} \]
    \[ \lim_{t\to 0} \frac{f(p + th) - f(p)}{t} = \d f(p)\cdot h \]
    \[ \frac{\p f}{\p h}(p) = \d f(p)\cdot h. \]
\end{proof}

\begin{definition}[jakobian]
    Dana jest funkcja $f : \RR^k \supset D \to \RR^m$, gdzie
    \[ f(p) = f(x_1, \ldots, x_k) = (f_1(x_1, \ldots, x_k), \ldots, f_m(x_1, \ldots, x_k)).\]
    Macierz
    \[ \d f(p) = \begin{bNiceMatrix}
        \frac{\p f_1}{\p x_1}(p) & \frac{\p f_1}{\p x_2}(p) & \Cdots & \frac{\p f_1}{\p x_k}(p) \\
        \frac{\p f_2}{\p x_1}(p) & \frac{\p f_2}{\p x_2}(p) & \Cdots & \frac{\p f_2}{\p x_k}(p) \\
        \Vdots & \Vdots & \Ddots & \Vdots \\
        \frac{\p f_m}{\p x_1}(p) & \frac{\p f_m}{\p x_2}(p) & \Cdots & \frac{\p f_m}{\p x_k}(p) \\
    \end{bNiceMatrix} \]
     nazywamy \vocab{macierzą Jacobiego} funkcji $f$ w punkcie $p$. Jeśli macierz ta jest kwadratowa, to jej wyznacznik nazywamy jakobianem funkcji $f$ w punkcie $p$ i oznaczamy $J(p)$.
\end{definition}

Chcąc obliczyć różniczkę $\d f(p)$ w punkcie $h$ wystarczy pomnożyć macierz $\d f(p)$ i wektor $h$, więc
\[ \d f(p)(h) = \begin{bNiceMatrix}
    \frac{\p f_1}{\p x_1}(p) & \frac{\p f_1}{\p x_2}(p) & \Cdots & \frac{\p f_1}{\p x_k}(p) \\
    \frac{\p f_2}{\p x_1}(p) & \frac{\p f_2}{\p x_2}(p) & \Cdots & \frac{\p f_2}{\p x_k}(p) \\
    \Vdots & \Vdots & \Ddots & \Vdots \\
    \frac{\p f_m}{\p x_1}(p) & \frac{\p f_m}{\p x_2}(p) & \Cdots & \frac{\p f_m}{\p x_k}(p) \\
\end{bNiceMatrix}\begin{bNiceMatrix}
    h_1 \\ h_2 \\ \Vdots \\ h_k
\end{bNiceMatrix} = \begin{bNiceMatrix}
    \frac{\p f_1}{\p x}(p)h_1 \\ \frac{\p f_2}{\p x}(p)h_2 \\ \Vdots \\ \frac{\p f_m}{\p x}(p)h_k
\end{bNiceMatrix} \]

\begin{theorem}[warunek konieczny różniczkowalności]
    Jeśli funkcja jest różniczkowalna w $x_0$, to jest ciągła w $x_0$.
\end{theorem}

\begin{theorem}[warunek wystarczający różniczkowalności]
    \label{t:differentiability of multivar functions}
    Jeśli istnieją i są ciągłe wszystkie pochodne cząstkowe funkcji $f$ w punkcie $x_0$, to funkcja $f$ jest różniczkowalna w $x_0$.
\end{theorem}

\begin{example}
    Zbadaj różniczkowalność funkcji
    \[ f(x, y) = \begin{cases}\frac{x^3 + y^3}{x^2 + x^2}, & \text{dla } (x, y) \neq (0, 0) \\ 0, & \text{w przeciwnym wypadku}\end{cases} \]
    w całej jej dziedzinie.
\end{example}
\begin{solution}
    Skorzystajmy z warunku wystarczającego na różniczkowalność funkcji. Pochodne cząstkowe
    \[ \frac{\p{}}{\p x}\left(\frac{x^3 + y^3}{x^2 + x^2}\right) = \frac{(3x^2)(x^2 + y^2) - (x^3 + y^3)(2x)}{(x^2 + y^2)^2} \]
    \[ \frac{\p{}}{\p y}\left(\frac{x^3 + y^3}{x^2 + x^2}\right) = \frac{(3y^2)(x^2 + y^2) - (x^3 + y^3)(2y)}{(x^2 + y^2)^2} \]
    są ciągłe w $\RR^2 \setminus \{(0, 0)\}$, więc w tym zbiorze funkcja $f$ jest różniczkowalna. Aby sprawdzić, czy funkcja jest również różniczkowalna w $p = (0, 0)$ policzymy pochodną w tym punkcie w kierunku wersora $h$:
    \begin{align*}
        &\lim_{t\to 0}\frac{f(p+th) - f(p)}{t} = \lim_{t\to 0}\frac{f(th)}{t} = \lim_{t\to 0}\frac{\frac{t^3\cos^3\varphi + t^3\sin^3\varphi}{t^2\cos^2\varphi + t^2\sin^2\varphi}}{t} = \\
        =& \lim_{t\to 0}\frac{t^3\cos^3\varphi + t^3\sin^3\varphi}{t^3} = \cos^3\varphi + \sin^3\varphi = h_1^3 + h_2^3.
    \end{align*}
    Na mocy warunku koniecznego różniczkowalności (\ref{t:differentiability implies derivability}) funkcja $f$ nie jest różniczkowalna w $(0, 0)$, ponieważ pochodna w kierunku $h$ powinna być wynikiem przekształcenia \textbf{liniowego} wektora $h$.
\end{solution}
\begin{solution}
    Pierwsza część alternatywnego rozwiązania przebiega tak samo, więc zbadamy tylko różniczkowalność funkcji $f$ w punkcie $(0, 0)$. Z definicji różniczki i macierzy Jacobiego mamy
    \[ \lim_{h\to\vec{0}} \frac{f(p + h) - f(p) - L_{p}(h)}{\Vert h \Vert} = \lim_{h\to\vec{0}} \frac{f(h) - L_{p}(h)}{\Vert h \Vert} = \lim_{h\to\vec{0}} \frac{\frac{h_1^3 + h_2^3}{h_1^2 + h_2^2} - \frac{\p f(0, 0)}{\p x}h_1 - \frac{\p f(0, 0)}{\p y}h_2}{\Vert h \Vert}. \]
    Możemy policzyć z definicji pochodnej
    \[ \frac{\p f(0, 0)}{\p x} = \lim_{t\to 0}\frac{f(t, 0) - f(0, 0)}{t} = \frac{\frac{t^3}{t^2}}{t} = 1 \]
    \[ \frac{\p f(0, 0)}{\p y} = \lim_{t\to 0}\frac{f(0, t) - f(0, 0)}{t} = \frac{\frac{t^3}{t^2}}{t} = 1, \]
    więc
    \begin{align*}
        &\lim_{h\to\vec{0}} \frac{\frac{h_1^3 + h_2^3}{h_1^2 + h_2^2} - \frac{\p f(0, 0)}{\p x}h_1 - \frac{\p f(0, 0)}{\p y}h_2}{\Vert h \Vert} = \lim_{h\to\vec{0}} \frac{\frac{h_1^3 + h_2^3}{h_1^2 + h_2^2} - h_1 - h_2}{\Vert h \Vert} = \\
        =& \lim_{r\to 0}\frac{\frac{r^3(\cos^3\varphi + \sin^3\varphi)}{r^2} - r\cos\varphi - r\sin\varphi}{r} = \cos^3\varphi + \sin^3\varphi - \cos\varphi + \sin\varphi \neq 0,
    \end{align*}
    więc funkcja $f$ nie jest różniczkowalna w $(0, 0)$.
\end{solution}

\begin{remark}
    Warunek wystarczający (\ref{t:differentiability of multivar functions}) nie jest równocześnie warunkiem koniecznym (to znaczy, że twierdzenie nie jest tożsamością). Przykładem niech będzie funkcja
    \[ f(x, y) = \begin{cases}(x^2 + y^2)\sin\left(\frac{1}{\sqrt{x^2 + x^2}}\right), & \text{dla } (x, y) \neq (0, 0) \\ 0, & \text{w przeciwnym wypadku}\end{cases}. \]
\end{remark}

W przypadku funkcji $\RR \to \RR$ różniczkowalność w punkcie znaczy, że istnieje styczna do wykresu funkcji w tym punkcie. W podobny sposób możemy zinterpretwać geometrycznie różniczkowalność funkcji $\RR^2 \to \RR$: funkcja jest równiczkowalna w punkcie, gdy w tym punkcie istnieje płaszczyzna styczna do wykresu funkcji. Taka płaszczyzna będzie mieć równanie
\begin{equation}
    z = f(x_0, y_0) + \frac{\p f}{\p x}(x_0, y_0) \cdot (x - x_0) + \frac{\p f}{\p y}(x_0, y_0) \cdot (y -y_0).
\end{equation}

\begin{example}
    Znajdź równanie płaszczyzny stycznej do funkcji
    \[ f(x, y) = e^{x^2 - y} \]
    w punkcie $p = (1, 0)$.
\end{example}
\begin{solution}
    Najpierw znajdźmy pochodne cząstowe:
    \begin{align*}
        \frac{\p f}{\p x}f(x, y) = e^{x^2 - y} \cdot 2x = 2xe^{x^2 - y} \\
        \frac{\p f}{\p y}f(x, y) = e^{x^2 - y} \cdot (-1) = -e^{x^2 - y}.
    \end{align*}
    Płaszczyzna styczna w punkcie $p$ ma więc wzór
    \[ z  = e^{1 - 0} + 2\cdot 1\cdot e^{1 - 0}\cdot (x - 1) - e^{1 - 0}\cdot (y - 0) \]
    \[ z  = 2ex - ey - e. \]
\end{solution}

\begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=0.8]
        \begin{axis}[my axis style, view = {-15}{30}]
            \addplot3[surf, opacity=0.1, colormap={CM}{rgb255=(255,0,0) rgb255=(255,0,0)},
                domain = -1.5:1.5, domain y = -1.5:1.5,
                samples = 10, samples y = 10
            ]{e*(2*x - y - 1)};
            \addplot3[
                domain = -1.5:1.5, domain y = -1.5:1.5,
                samples = 24, samples y = 24,
                mesh
            ]{exp(x^2 - y)};
            \node[draw=none, shape=circle, fill, opacity=0.7, red, inner sep=1.5pt] (d1) at (1,0,e){};
        \end{axis}
    \end{tikzpicture}
    \begin{tikzpicture}[scale=0.8]
        \begin{axis}[my axis style, view = {10}{10}]
            \addplot3[surf, opacity=0.1, colormap={CM}{rgb255=(255,0,0) rgb255=(255,0,0)},
                domain = -1.5:1.5, domain y = -1.5:1.5,
                samples = 10, samples y = 10
            ]{e*(2*x - y - 1)};
            \addplot3[
                domain = -1.5:1.5, domain y = -1.5:1.5,
                samples = 24, samples y = 24,
                mesh
            ]{exp(x^2 - y)};
            \node[draw=none, shape=circle, fill, opacity=0.7, red, inner sep=1.5pt] (d1) at (1,0,e){};
        \end{axis}
    \end{tikzpicture}
    \caption{Wykres funkcji $f(x, y) = e^{x^2 - y}$ z płaszczyzną styczną w $(1, 0)$.}
\end{figure}

Również analogicznie do funkcji $\RR \to \RR$ możemy za pomocą pochodnych przybliżać wartości funkcji $\RR^k \to \RR$. Mamy
\begin{equation}
    f(x_0 + h) \approx f(x_0) + \d f(x_0)(h),
\end{equation}
jeśli tylko funkcja $f$ jest różniczkowalna w otoczeniu $x_0$.

Pochodna cząstkowa \vocab{drugiego rzędu} to pochodna
\[ \frac{\p{}^2 f}{\p x_j \p x_i} = \frac{\p{}}{\p x_j}\left(\frac{\p f}{\p x_i}\right). \]
Jeśli $i = j$, czyli pochodna ma postać $\frac{\p{}^2 f}{\p{} x^2}$, to nazywamy ją pochodną \vocab{czystą}, a przeciwnym wypadku jest \vocab{mieszana}.

Analogicznie do twierdzenia \ref{t:differentiability of multivar functions} funkcja $f: D \supset \RR^k \to \RR^m$ jest \vocab{$2$-krotnie różniczkowalna} w punkcie $p$, gdy istnieją i są ciągłe wszystkie (jest ich $k^2$) pochodne cząstkowe $2$-go rzędu funkcji $f$ w punkcie $p$.

\begin{theorem}[Schwarza o pochodnych mieszanych]
    Jeśli funkcja $f$ jest $2$-krotnie różniczkowalna w $p$, to
    \[ \frac{\p{}^2 f}{\p x \p y}(p) = \frac{\p{}^2 f}{\p y \p x}(p). \]
\end{theorem}

Jeśli funkcja $f:\RR^2 \to \RR$ jest $2$-krotnie różniczkowalna, to możemy zdefiniować różniczkę $2$-go rzędu:
\begin{align*}
    &\d{}^2 f(h_1, h_2) = \d{} \left(\frac{\p f}{\p x} h_1 + \frac{\p f}{\p y} h_2\right) = \frac{\p f}{\p x}\left(\frac{\p f}{\p x} h_1 + \frac{\p f}{\p y} h_2\right)h_1 + \frac{\p f}{\p y}\left(\frac{\p f}{\p x} h_1 + \frac{\p f}{\p y} h_2\right)h_2 \\
    &= \frac{\p{}^2 f}{\p x^2} + 2\frac{\p f}{\p x\p y} + \frac{\p{}^2 f}{\p y^2}.
\end{align*}