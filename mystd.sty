\ProvidesPackage{mystd}

\usepackage{fontspec}
\newfontfamily{\cyrillic}[
    UprightFont=*rm,
    BoldFont=*bx,
    ItalicFont=*ti,
    BoldItalicFont=*bi,
    Extension=.otf,
    Ligatures=TeX
]{cmun}
\setmonofont{JetBrainsMono}[
    Path=./fonts/,
    Scale=0.85,
    Extension=.ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    BoldItalicFont=*-BoldItalic
]

\usepackage{amsmath,amssymb,amsthm,amsfonts}
\usepackage[svgnames,dvipsnames]{xcolor}

\definecolor{AccColor1}{HTML}{C41E3A}     %#C41E3A
\definecolor{AccColor2}{HTML}{233F8D}     %#233F8D
\definecolor{AccColor3}{HTML}{D19820}     %#D19820
\definecolor{AccColor4}{HTML}{148670}     %#148670

\colorlet{ColAccGood}{AccColor4}          %#148670
\definecolor{ColAccBad}{HTML}{D14B20}     %#D14B20

\colorlet{MainColor}{AccColor1}           %#C41E3A
\definecolor{LinkColor1}{HTML}{329B71}    %#329B71
\colorlet{LinkColor2}{AccColor2}          %#233F8D

\definecolor{BoxColor1}{HTML}{081D56}     %#081D56
\definecolor{BoxColor2}{HTML}{A8760F}     %#A8760F

\usepackage[colorlinks=true]{hyperref}
\hypersetup{urlcolor=LinkColor1,linkcolor=LinkColor2,citecolor=LinkColor2}
\usepackage[nameinlink]{cleveref}
\usepackage{thmtools}
\usepackage{relsize}
\usepackage{yhmath}  % for wideparen
\usepackage{esint}  % better integrals
\usepackage{graphicx}
\usepackage{float}
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{tkz-euclide}
\usetikzlibrary{math,shapes.geometric,calc,positioning,fit,decorations.markings}
\tikzset{>=latex}
\usepackage{nicematrix}
\NiceMatrixOptions{
    custom-line={letter=I, tikz=densely dashed, total-width=\pgflinewidth},
    custom-line={letter=S, tikz=solid, total-width=\pgflinewidth}
}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}


\newif\ifstdthm\stdthmfalse
\newif\ifstdcolorsec\stdcolorsecfalse
\newif\ifstdpolish\stdpolishfalse

\DeclareOption{pretty}{\stdthmtrue\stdcolorsectrue}

\DeclareOption{thm}{\stdthmtrue}
\DeclareOption{nothm}{\stdthmfalse}
\DeclareOption{colorsec}{\stdcolorsectrue}
\DeclareOption{nocolorsec}{\stdcolorsecfalse}
\DeclareOption{polish}{\stdpolishtrue}

\ProcessOptions\relax

\ifstdpolish
    \usepackage[polish]{babel}
\fi


%  ----------  SHORT AND USEFUL STUFF  ----------  %

\DeclareMathOperator{\cis}{cis}
\DeclareMathOperator*{\lcm}{lcm}
\DeclareMathOperator{\rank}{rank}

\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceiling}[1]{\left\lceil #1 \right\rceil}
\newcommand{\ol}{\overline}
\newcommand{\ul}{\underline}
\newcommand{\wt}{\widetilde}
\newcommand{\wh}{\widehat}
\newcommand{\arc}{\wideparen}
\newcommand{\eps}{\varepsilon}
\newcommand{\dg}{^\circ}
\renewcommand{\d}[1]{\ensuremath{\operatorname{d}\!{#1}}}
\newcommand{\p}[1]{\ensuremath{\operatorname{\partial}\!{#1}}}
\newcommand{\ddx}{\frac{\d{}}{\d x}}
\newcommand{\dforall}[1]{\displaystyle\mathop{\mathlarger{\mathlarger{\forall}}}_{#1}\ }
\newcommand{\dexists}[1]{\displaystyle\mathop{\mathlarger{\mathlarger{\exists}}}_{#1}\ }
\newcommand{\dexistsone}[1]{\displaystyle\mathop{\mathlarger{\mathlarger{\exists!}}}_{#1}\ }
\renewcommand{\iff}{\Leftrightarrow}
\renewcommand{\implies}{\Rightarrow}

\newcommand{\vocab}[1]{\emph{\color{MainColor} #1}}
\newcommand{\hrulebar}{
  \par\hspace{\fill}\rule{0.95\linewidth}{.7pt}\hspace{\fill}
  \par\nointerlineskip \vspace{\baselineskip}
}

\newcommand{\NN}{\mathbb N}
\newcommand{\ZZ}{\mathbb Z}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\RR}{\mathbb R}
\newcommand{\CC}{\mathbb C}
\newcommand{\KK}{\mathbb K}

\newcommand{\liff}{\leftrightarrow}
\newcommand{\opname}{\operatorname}
\newcommand{\surjto}{\twoheadrightarrow}
\newcommand{\injto}{\hookrightarrow}

\newcommand{\sA}{\mathcal A}
\newcommand{\sB}{\mathcal B}
\newcommand{\sC}{\mathcal C}
\newcommand{\sD}{\mathcal D}
\newcommand{\sF}{\mathcal F}
\newcommand{\sG}{\mathcal G}
\newcommand{\sH}{\mathcal H}
\newcommand{\sL}{\mathcal L}
\newcommand{\sM}{\mathcal M}
\newcommand{\sR}{\mathcal R}
\newcommand{\sS}{\mathcal S}

\newcommand{\scA}{\mathscr A}
\newcommand{\scB}{\mathscr B}
\newcommand{\scC}{\mathscr C}
\newcommand{\scD}{\mathscr D}
\newcommand{\scE}{\mathscr E}
\newcommand{\scF}{\mathscr F}
\newcommand{\scG}{\mathscr G}
\newcommand{\scH}{\mathscr H}

\newcommand{\km}{\mathfrak m}
\newcommand{\kp}{\mathfrak p}
\newcommand{\kq}{\mathfrak q}

\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
%  ----------------------------------------------  %

\renewcommand{\thepart}{}
\renewcommand{\partname}{}
\addto{\captionspolish}{
  \renewcommand{\partname}{}
}

\ifstdpolish
    \newenvironment{solution}{\begin{proof}[Rozwiązanie]\small}{\end{proof}}
\else
    \newenvironment{solution}{\begin{proof}[Solution]\small}{\end{proof}}
\fi

\ifstdthm
    \usepackage[framemethod=TikZ]{mdframed}
    \mdfdefinestyle{mdbluebox}{%
        skipabove=12pt,
        skipbelow=2pt,
        linewidth=0.5pt,
        innerbottommargin=9pt,
        linecolor=BoxColor1,
        backgroundcolor=BoxColor1!5,
        nobreak=true
    }
    \declaretheoremstyle[
        headfont=\sffamily\bfseries\color{BoxColor1},
        mdframed={style=mdbluebox},
        headpunct={\\[3pt]},
        postheadspace={0pt}
    ]{thmbluebox}
    \mdfdefinestyle{mdredbox}{%
        skipabove=8pt,
        linewidth=2pt,
        rightline=false,
        leftline=true,
        topline=false,
        bottomline=false,
        linecolor=BoxColor2,
        backgroundcolor=BoxColor2!5,
        nobreak=true
    }
    \declaretheoremstyle[
        headfont=\bfseries\color{BoxColor2},
        bodyfont=\normalfont\small,
        mdframed={style=mdredbox},
        headpunct={\\[3pt]},
        postheadspace={0pt}
    ]{thmredbox}
    \mdfdefinestyle{mdblackbox}{%
        skipabove=8pt,
        linewidth=2pt,
        rightline=false,
        leftline=true,
        topline=false,
        bottomline=false,
        linecolor=black,
        backgroundcolor=black!3,
    }
    \declaretheoremstyle[
        headfont=\bfseries,
        bodyfont=\normalfont\small,
        mdframed={style=mdblackbox},
        spaceabove=0pt,
        spacebelow=0pt
    ]{thmblackbox}
\else
    \declaretheoremstyle[headfont=\bfseries,bodyfont=\normalfont,spaceabove=\topsep,spacebelow=\topsep]{thmbluebox}
    \declaretheoremstyle[headfont=\bfseries,bodyfont=\normalfont,spaceabove=\topsep,spacebelow=\topsep]{thmredbox}
    \declaretheoremstyle[headfont=\bfseries,bodyfont=\normalfont,spaceabove=\topsep,spacebelow=\topsep]{thmblackbox}
\fi

\theoremstyle{definition}

\ifstdpolish
    \declaretheorem[style=thmbluebox,name=Twierdzenie,numberwithin=section]{theorem}
    \declaretheorem[style=thmbluebox,name=Twierdzenie,numbered=no]{theorem*}
    \declaretheorem[style=thmbluebox,name=Lemat,sibling=theorem]{lemma}
    \declaretheorem[style=thmbluebox,name=Lemat,numbered=no]{lemma*}
    \declaretheorem[style=thmbluebox,name=Wniosek,sibling=theorem]{corollary}
    \declaretheorem[style=thmbluebox,name=Wniosek,numbered=no]{corollary*}
    \declaretheorem[style=thmredbox,name=Przykład,sibling=theorem]{example}
    \declaretheorem[style=thmredbox,name=Przykład,numbered=no]{example*}
    \declaretheorem[style=thmblackbox,name=Uwaga,sibling=theorem]{remark}
    \declaretheorem[style=thmblackbox,name=Uwaga,numbered=no]{remark*}
    \declaretheorem[name=Przypuszczenie,sibling=theorem]{conjecture}
    \declaretheorem[name=Przypuszczenie,numbered=no]{conjecture*}
    \declaretheorem[name=Definicja,sibling=theorem]{definition}
    \declaretheorem[name=Definicja,numbered=no]{definition*}
    \declaretheorem[name=Ćwiczenie,sibling=theorem]{exercise}
    \declaretheorem[name=Ćwiczenie,numbered=no]{exercise*}
    \declaretheorem[name=Fakt,sibling=theorem]{fact}
    \declaretheorem[name=Fakt,numbered=no]{fact*}
    \declaretheorem[name=Problem,sibling=theorem]{problem}
    \declaretheorem[name=Problem,numbered=no]{problem*}
    \declaretheorem[name=Pytanie,sibling=theorem]{question}
    \declaretheorem[name=Pytanie,numbered=no]{question*}
\else
    \declaretheorem[style=thmbluebox,name=Theorem,numberwithin=section]{theorem}
    \declaretheorem[style=thmbluebox,name=Theorem,numbered=no]{theorem*}
    \declaretheorem[style=thmbluebox,name=Lemma,sibling=theorem]{lemma}
    \declaretheorem[style=thmbluebox,name=Lemma,numbered=no]{lemma*}
    \declaretheorem[style=thmbluebox,name=Corollary,sibling=theorem]{corollary}
    \declaretheorem[style=thmbluebox,name=Corollary,numbered=no]{corollary*}
    \declaretheorem[style=thmredbox,name=Example,sibling=theorem]{example}
    \declaretheorem[style=thmredbox,name=Example,numbered=no]{example*}
    \declaretheorem[style=thmblackbox,name=Remark,sibling=theorem]{remark}
    \declaretheorem[style=thmblackbox,name=Remark,numbered=no]{remark*}
    \declaretheorem[name=Conjecture,sibling=theorem]{conjecture}
    \declaretheorem[name=Conjecture,numbered=no]{conjecture*}
    \declaretheorem[name=Definition,sibling=theorem]{definition}
    \declaretheorem[name=Definition,numbered=no]{definition*}
    \declaretheorem[name=Exercise,sibling=theorem]{exercise}
    \declaretheorem[name=Exercise,numbered=no]{exercise*}
    \declaretheorem[name=Fact,sibling=theorem]{fact}
    \declaretheorem[name=Fact,numbered=no]{fact*}
    \declaretheorem[name=Problem,sibling=theorem]{problem}
    \declaretheorem[name=Problem,numbered=no]{problem*}
    \declaretheorem[name=Question,sibling=theorem]{question}
    \declaretheorem[name=Question,numbered=no]{question*}
\fi

\ifstdcolorsec
    \@ifundefined{chapter}{}{
        \addtokomafont{partprefix}{\rmfamily}
        \renewcommand*{\partformat}{\color{MainColor}
            \scalebox{2.5}{\thepart}\enlargethispage{2em}}
        \addtokomafont{chapterprefix}{\raggedleft}
        \RedeclareSectionCommand[beforeskip=0.5em]{chapter}
        \renewcommand*{\chapterformat}{\mbox{%
            \scalebox{1.5}{\chapappifchapterprefix{\nobreakspace}}%
            \scalebox{2.718}{\color{MainColor}\thechapter}\enskip}}
    }
    \renewcommand*{\sectionformat}%
        {\color{MainColor}\S\thesection\enskip}
    \renewcommand*{\subsectionformat}%
        {\color{MainColor}\S\thesubsection\enskip}
    \renewcommand*{\subsubsectionformat}%
        {\color{MainColor}\S\thesubsubsection\enskip}
    \KOMAoptions{numbers=noenddot}
\fi

\usepackage{listings}
\usepackage{mathrsfs}
\usepackage{textcomp}
\lstset{
    basicstyle=\footnotesize\ttfamily,
    numberstyle=\ttfamily,
    numbers=left,
    numbersep=5pt,
    numberstyle=\tiny,
    keywordstyle=\bfseries,
    showstringspaces=false,
    tabsize=4,
    frame=single,
    keywordstyle=\bfseries\color{blue},
    commentstyle=\color{green!70!black},
    identifierstyle=\color{green!20!black},
    stringstyle=\color{orange},
    breaklines=true,
    breakatwhitespace=true,
    frame=none
}
\usepackage[shortlabels]{enumitem}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{mathtools}
\usepackage{microtype}

\addtokomafont{subtitle}{\Large}
\setkomafont{author}{\Large\slshape}
\setkomafont{date}{\small}
\setkomafont{caption}{\small}
\providecommand{\thetitle}{\@title}
\providecommand{\theauthor}{\@author}
\providecommand{\thedate}{\@date}
\usepackage[headsepline]{scrlayer-scrpage}
\renewcommand{\headfont}{}
\addtolength{\textheight}{3.14cm}
\setlength{\footskip}{0.5in}
\setlength{\headsep}{10pt}
\automark{section}
\ihead{\footnotesize\textsl{\textbf{\theauthor}}}
\chead{}
\ohead{\footnotesize\textbf{\thetitle}}
\cfoot{\pagemark}

\usepackage{answers}
\renewcommand{\solutionextension}{out}

\Newassociation{hint}{hintitem}{hints}
\Opensolutionfile{hints}
\newcommand{\makehints}{\Closesolutionfile{hints}\input{hints.out}}

\Newassociation{answer}{hintitem}{answers}
\Opensolutionfile{answers}
\newcommand{\makeanswers}{\Closesolutionfile{answers}\input{answers.out}}